(DEFINE-FILE-INFO PACKAGE "INTERLISP" READTABLE "XCL" BASE 10)

(FILECREATED "13-Oct-2022 11:18:41" |{DSK}<home>larry>loops>system>INSPECT-PATCH.;2| 2718   )


; Copyright (c) 1988, 1990, 2022 by Venue & Xerox Corporation.

(PRETTYCOMPRINT INSPECT-PATCHCOMS)

(RPAQQ INSPECT-PATCHCOMS ((FNS INSPECT/AS/FUNCTION)))
(DEFINEQ

(INSPECT/AS/FUNCTION
  (LAMBDA (ATM STKP WINDOW)                                 (* \; "Edited 13-Oct-2022 11:07 by lmm")
                                                             (* \; "Edited 14-Jun-88 16:11 by raf")

    (* |;;| "calls an editor on function ATM.  STKP and WINDOW are the stack pointer and window of the break in which this inspect command was called")

    (LET ((EDITOR (SELECT.FNS.EDITOR ATM))
          FRAME CODEBASE PROC)
         (AND EDITOR
              (|if| (EQ EDITOR 'INSPECTCODE)
                  |then| (COND
                            ((AND (STACKP STKP)
                                  (NOT (|fetch| (FX INVALIDP) |of| (SETQ FRAME (|fetch| (STACKP
                                                                                         EDFXP)
                                                                                  |of| STKP)))))
                             (INSPECTCODE (COND
                                             ((EQ (\\GET-COMPILED-CODE-BASE ATM)
                                                  (SETQ CODEBASE (|fetch| (FX FNHEADER) |of| FRAME)))
                                              ATM)
                                             (T 

                                 (* |;;| "Function executing in this frame is not the one in the definition cell of its name, so fetch the real code.  Have to pass a CCODEP")

                                                (MAKE-COMPILED-CLOSURE CODEBASE)))
                                    NIL NIL NIL (|fetch| (FX PC) |of| FRAME)))
                            (T (INSPECTCODE ATM)))
                |else| (LET ((PROC (AND WINDOW (WINDOWPROP WINDOW 'PROCESS)))
                             (EDITORARGS (|if| (EQ EDITOR 'ED)
                                             |then| (LIST ATM '(METHOD-FNS FUNCTIONS FNS :DONTWAIT 
                                                                      :DISPLAY))
                                           |else| (LIST ATM))))
                            (|if| PROC
                                |then| (PROCESS.APPLY PROC EDITOR EDITORARGS)
                              |else| (CL:APPLY EDITOR EDITORARGS))))))))
)
(PUTPROPS INSPECT-PATCH COPYRIGHT ("Venue & Xerox Corporation" 1988 1990 2022))
(DECLARE\: DONTCOPY
  (FILEMAP (NIL (327 2615 (INSPECT/AS/FUNCTION 337 . 2613)))))
STOP
